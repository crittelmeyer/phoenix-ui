---
phase: 06-ai-integration
plan: 03
type: execute
wave: 2
depends_on: ['06-01', '06-02']
files_modified:
  - packages/ui/src/components/accordion.tsx
  - packages/ui/src/components/accordion.figma.tsx
  - apps/storybook/stories/Accordion.stories.tsx
  - packages/ui/src/index.ts
autonomous: false

must_haves:
  truths:
    - 'Claude can add an Accordion component by following CLAUDE.md and .claude/rules/ without prior context'
    - 'Accordion component typechecks successfully'
    - 'Accordion story renders in Storybook'
    - 'Accordion follows all Phoenix conventions (forwardRef, semantic tokens, cn(), displayName)'
    - 'Barrel export includes Accordion parts'
  artifacts:
    - path: 'packages/ui/src/components/accordion.tsx'
      provides: 'Accordion compound component'
      contains: 'forwardRef'
    - path: 'packages/ui/src/components/accordion.figma.tsx'
      provides: 'Accordion Figma Code Connect mapping'
      contains: 'figma.connect'
    - path: 'apps/storybook/stories/Accordion.stories.tsx'
      provides: 'Accordion stories'
      contains: 'satisfies Meta'
    - path: 'packages/ui/src/index.ts'
      provides: 'Updated barrel export with Accordion'
      contains: 'Accordion'
  key_links:
    - from: 'packages/ui/src/components/accordion.tsx'
      to: '@radix-ui/react-accordion'
      via: 'import'
      pattern: 'radix-ui/react-accordion'
    - from: 'packages/ui/src/index.ts'
      to: 'packages/ui/src/components/accordion.tsx'
      via: 'barrel re-export'
      pattern: "from './components/accordion'"
    - from: 'apps/storybook/stories/Accordion.stories.tsx'
      to: '@phoenix/ui'
      via: 'import'
      pattern: "from '@phoenix/ui'"
---

<objective>
Validate that CLAUDE.md and .claude/rules/ documentation enables autonomous component creation by adding an Accordion component.

Purpose: This is the proof point for the entire Phoenix project's core value - AI agents can add components without human hand-holding. The validation proves documentation sufficiency.

Output: Working Accordion component (compound component with Radix primitive) + story + Figma mapping + updated barrel export.
</objective>

<execution_context>
@/Users/chris/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@CLAUDE.md
@AGENTS.md
@.claude/rules/ui-components.md
@.claude/rules/token-authoring.md
@.claude/rules/storybook-stories.md

IMPORTANT: This plan validates the documentation created in 06-01 and 06-02.
The executor should follow the documentation files above as their PRIMARY guide,
NOT the instructions in this plan. The plan's role is to define WHAT to build
and HOW to verify - the docs define HOW to build it.

If the executor gets stuck or produces incorrect output, the docs need fixing
(iterate on 06-01/06-02), not this plan.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Radix Accordion and create Accordion component following documentation</name>
  <files>packages/ui/src/components/accordion.tsx, packages/ui/src/components/accordion.figma.tsx, apps/storybook/stories/Accordion.stories.tsx, packages/ui/src/index.ts</files>
  <action>
Follow the documentation in CLAUDE.md and .claude/rules/ui-components.md to add an Accordion component.

**Pre-step:** Install the Radix Accordion primitive:

```bash
cd packages/ui && pnpm add @radix-ui/react-accordion
```

**Then follow the component authoring checklist from .claude/rules/ui-components.md:**

1. Create `packages/ui/src/components/accordion.tsx` using the compound component template
   - Accordion is a compound component with parts: Root, Item, Trigger, Content
   - Use @radix-ui/react-accordion primitive
   - AccordionItem wraps AccordionPrimitive.Item with border-b border-border
   - AccordionTrigger wraps AccordionPrimitive.Trigger with flex layout, hover underline, and a chevron SVG icon that rotates on open (data-[state=open]:rotate-180 transition-transform)
   - AccordionContent wraps AccordionPrimitive.Content with overflow-hidden and animate-accordion-down/up animations (use data-[state] attributes)
   - All parts use forwardRef, cn(), semantic tokens, and displayName

2. Create `packages/ui/src/components/accordion.figma.tsx` using the Figma template
   - Map type prop (single/multiple) to Figma enum
   - Example shows Accordion with AccordionItem, AccordionTrigger, AccordionContent

3. Create `apps/storybook/stories/Accordion.stories.tsx` using the story template
   - Default story: 3 accordion items with trigger text and content
   - Multiple story: type="multiple" allowing multiple items open
   - Use CSF 3.0 format with satisfies Meta, tags: ['autodocs'], subcomponents

4. Update `packages/ui/src/index.ts` barrel export
   - Export all Accordion parts: Accordion, AccordionItem, AccordionTrigger, AccordionContent

**Verification sequence:**

```bash
pnpm typecheck
```

NOTE: The Accordion component uses CSS animations for open/close. If @keyframes for accordion-down and accordion-up don't exist in the project's CSS, add them to both `apps/web/src/index.css` and `apps/storybook/stories/index.css` in the @theme section:

```css
--animate-accordion-down: accordion-down 0.2s ease-out;
--animate-accordion-up: accordion-up 0.2s ease-out;
```

And the keyframes:

```css
@keyframes accordion-down {
  from {
    height: 0;
  }
  to {
    height: var(--radix-accordion-content-height);
  }
}
@keyframes accordion-up {
  from {
    height: var(--radix-accordion-content-height);
  }
  to {
    height: 0;
  }
}
```

  </action>
  <verify>
    - Component file exists: `test -f packages/ui/src/components/accordion.tsx && echo "exists"`
    - Figma file exists: `test -f packages/ui/src/components/accordion.figma.tsx && echo "exists"`
    - Story file exists: `test -f apps/storybook/stories/Accordion.stories.tsx && echo "exists"`
    - Barrel export updated: `grep "accordion" packages/ui/src/index.ts`
    - TypeScript passes: `pnpm typecheck`
    - Uses forwardRef: `grep "forwardRef" packages/ui/src/components/accordion.tsx`
    - Uses semantic tokens: `grep -v "style=" packages/ui/src/components/accordion.tsx | grep -c "cn("` returns 3+
    - Has displayName: `grep "displayName" packages/ui/src/components/accordion.tsx`
    - No inline styles: `grep -c "style=" packages/ui/src/components/accordion.tsx` returns 0
    - No arbitrary values: `grep -c "\[#" packages/ui/src/components/accordion.tsx` returns 0
  </verify>
  <done>Accordion component, Figma mapping, story, and barrel export all created following documented patterns. pnpm typecheck passes. Component uses forwardRef, cn(), semantic tokens, displayName on all parts. No inline styles or arbitrary values.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Accordion component added to Phoenix design system following CLAUDE.md and .claude/rules/ documentation. This validates that the AI agent documentation is sufficient for autonomous component creation.

Created files:

- packages/ui/src/components/accordion.tsx (compound component with Radix primitive)
- packages/ui/src/components/accordion.figma.tsx (Figma Code Connect mapping)
- apps/storybook/stories/Accordion.stories.tsx (CSF 3.0 stories)
- packages/ui/src/index.ts (updated barrel export)
  </what-built>
  <how-to-verify>

1. Run `pnpm storybook` and navigate to Components/Accordion
2. Verify Default story: Click accordion triggers, items expand/collapse with animation
3. Verify Multiple story: Multiple items can be open simultaneously
4. Check that Accordion matches visual style of other Phoenix components (semantic tokens, consistent spacing)
5. Verify keyboard navigation works (Tab to focus, Enter/Space to toggle)
6. Review the code quality:
   - `cat packages/ui/src/components/accordion.tsx` - forwardRef, cn(), semantic tokens, displayName
   - `cat packages/ui/src/index.ts` - Accordion exports present
   - `grep -c "style=" packages/ui/src/components/accordion.tsx` should return 0
   - `grep -c "\[#" packages/ui/src/components/accordion.tsx` should return 0

If the Accordion has issues, the documentation (CLAUDE.md, .claude/rules/) needs iteration, NOT this plan. Fix docs, then re-run validation.
</how-to-verify>
<resume-signal>Type "approved" if Accordion renders correctly and follows Phoenix patterns. If issues found, describe what went wrong so documentation can be improved.</resume-signal>
</task>

</tasks>

<verification>
1. All 4 Accordion files exist
2. `pnpm typecheck` passes
3. Accordion renders in Storybook with expand/collapse behavior
4. Code follows all Phoenix conventions (forwardRef, cn(), semantic tokens, displayName, no inline styles)
5. Barrel export includes all Accordion parts
6. Human verification confirms visual quality and keyboard navigation
</verification>

<success_criteria>

- Accordion component works as a compound component (Root, Item, Trigger, Content)
- Accordion uses @radix-ui/react-accordion primitive for accessibility
- All Accordion parts use forwardRef, cn(), semantic tokens, and displayName
- Accordion story renders in Storybook with expand/collapse animation
- Figma Code Connect mapping exists with placeholder URL
- Barrel export in index.ts includes all Accordion parts
- pnpm typecheck passes
- Human verifies Storybook rendering and keyboard navigation
- Requirement AIML-06 satisfied: Claude added component following documented patterns
  </success_criteria>

<output>
After completion, create `.planning/phases/06-ai-integration/06-03-SUMMARY.md`
</output>
