---
phase: 03-core-components
plan: 03
type: execute
wave: 2
depends_on: ['03-01']
files_modified:
  - packages/ui/src/components/dialog.tsx
  - packages/ui/src/index.ts
autonomous: true

must_haves:
  truths:
    - 'Dialog opens/closes with overlay, Escape key, and X button'
    - 'Dialog traps focus and returns focus to trigger on close'
    - 'Dialog animates with fade + scale on enter/exit'
    - 'All Phase 3 components are importable from @phoenix/ui'
    - 'Barrel export re-exports cn utility and all components'
  artifacts:
    - path: 'packages/ui/src/components/dialog.tsx'
      provides: 'Dialog compound component (Root, Trigger, Content, Header, Footer, Title, Description, Close)'
      exports:
        [
          'Dialog',
          'DialogPortal',
          'DialogOverlay',
          'DialogClose',
          'DialogTrigger',
          'DialogContent',
          'DialogHeader',
          'DialogFooter',
          'DialogTitle',
          'DialogDescription',
        ]
    - path: 'packages/ui/src/index.ts'
      provides: 'Barrel export for all Phase 3 components'
      exports:
        [
          'cn',
          'Button',
          'buttonVariants',
          'Input',
          'Textarea',
          'Select',
          'Checkbox',
          'RadioGroup',
          'RadioGroupItem',
          'Label',
          'Dialog',
        ]
  key_links:
    - from: 'packages/ui/src/index.ts'
      to: 'packages/ui/src/components/*.tsx'
      via: 'barrel re-exports'
      pattern: 'export.*from.*components/'
    - from: 'packages/ui/src/components/dialog.tsx'
      to: '@radix-ui/react-dialog'
      via: 'Radix Dialog primitives'
      pattern: 'import.*DialogPrimitive.*from.*@radix-ui/react-dialog'
---

<objective>
Build the Dialog compound component on Radix Dialog primitive, then create the barrel export file that re-exports all Phase 3 components from packages/ui.

Purpose: Dialog is the most complex component (compound parts, portal, overlay, animations, focus trap). Barrel export enables the intended import pattern: `import { Button, Input } from "@phoenix/ui"`.

Output: dialog.tsx component file and updated index.ts barrel export.
</objective>

<execution_context>
@/Users/chris/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-core-components/03-RESEARCH.md
@.planning/phases/03-core-components/03-CONTEXT.md
@.planning/phases/03-core-components/03-01-SUMMARY.md
@packages/ui/src/lib/utils.ts
@apps/web/src/index.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Dialog compound component</name>
  <files>
    packages/ui/src/components/dialog.tsx
  </files>
  <action>
    Create `packages/ui/src/components/dialog.tsx` following the shadcn/ui Dialog pattern.

    Import `* as DialogPrimitive from "@radix-ui/react-dialog"`.

    **Parts to export (all from one file):**

    - `Dialog` = DialogPrimitive.Root (re-export as-is)
    - `DialogTrigger` = DialogPrimitive.Trigger (re-export as-is)
    - `DialogPortal` = DialogPrimitive.Portal (re-export as-is)
    - `DialogClose` = DialogPrimitive.Close (re-export as-is)

    - `DialogOverlay` — forwardRef wrapper around DialogPrimitive.Overlay:
      - Classes: fixed inset-0 z-50 bg-black/80
      - Animation: data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0

    - `DialogContent` — forwardRef wrapper around DialogPrimitive.Content:
      - Wraps content in DialogPrimitive.Portal with DialogOverlay rendered inside
      - Classes: fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 sm:rounded-lg
      - Animation: data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]
      - Include X close button in top-right corner:
        ```tsx
        <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
          {/* X icon SVG */}
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="h-4 w-4"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
          <span className="sr-only">Close</span>
        </DialogPrimitive.Close>
        ```

    - `DialogHeader` — plain div (not forwardRef needed):
      - Classes: flex flex-col space-y-1.5 text-center sm:text-left
      - TypeScript: React.HTMLAttributes<HTMLDivElement>

    - `DialogFooter` — plain div:
      - Classes: flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2
      - TypeScript: React.HTMLAttributes<HTMLDivElement>

    - `DialogTitle` — forwardRef wrapper around DialogPrimitive.Title:
      - Classes: text-lg font-semibold leading-none tracking-tight

    - `DialogDescription` — forwardRef wrapper around DialogPrimitive.Description:
      - Classes: text-sm text-muted-foreground

    All forwardRef components: set displayName, use cn() for className merging, spread {...props}.

    Per CONTEXT.md Dialog specifics:
    - Close triggers: overlay click + Escape + X button (all three — Radix handles overlay/Escape by default, X button added in Content)
    - Animation: fade + scale (95% to 100%) — achieved via animate-in/animate-out + zoom-in-95/zoom-out-95
    - Compound parts API matches shadcn exactly

    Note: Size variants (sm/md/lg/full from CONTEXT.md) are NOT built into the component — users apply max-w-sm/max-w-lg/max-w-[90vw] via className prop on DialogContent. This follows shadcn convention (className override, not variant prop).

  </action>
  <verify>
    - `pnpm turbo run typecheck` passes
    - File exports all 10 named exports (Dialog, DialogPortal, DialogOverlay, DialogClose, DialogTrigger, DialogContent, DialogHeader, DialogFooter, DialogTitle, DialogDescription)
    - displayName set on all forwardRef components
    - No inline styles or arbitrary color values
  </verify>
  <done>
    Dialog compound component with overlay, animations (fade + scale), close button, focus trap, and portal rendering. All parts exported for composable usage.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create barrel export and verify full component library</name>
  <files>
    packages/ui/src/index.ts
  </files>
  <action>
    Update `packages/ui/src/index.ts` to re-export everything from all Phase 3 modules:

    ```typescript
    // Utilities
    export { cn } from "./lib/utils"

    // Components
    export { Button, buttonVariants } from "./components/button"
    export type { ButtonProps } from "./components/button"

    export { Input } from "./components/input"
    export type { InputProps } from "./components/input"

    export { Textarea } from "./components/textarea"
    export type { TextareaProps } from "./components/textarea"

    export {
      Select,
      SelectGroup,
      SelectValue,
      SelectTrigger,
      SelectContent,
      SelectLabel,
      SelectItem,
      SelectSeparator,
      SelectScrollUpButton,
      SelectScrollDownButton,
    } from "./components/select"

    export { Checkbox } from "./components/checkbox"

    export { RadioGroup, RadioGroupItem } from "./components/radio-group"

    export { Label } from "./components/label"

    export {
      Dialog,
      DialogPortal,
      DialogOverlay,
      DialogClose,
      DialogTrigger,
      DialogContent,
      DialogHeader,
      DialogFooter,
      DialogTitle,
      DialogDescription,
    } from "./components/dialog"
    ```

    This barrel export enables the target import pattern:
    ```typescript
    import { Button, Input, Dialog, DialogContent } from "@phoenix/ui"
    ```

    After writing the barrel file, run full verification:
    1. `pnpm turbo run typecheck` — must pass across all packages
    2. `pnpm --filter @phoenix/ui run lint` — no lint errors
    3. Verify apps/web can import from @phoenix/ui (typecheck covers this via workspace references)

  </action>
  <verify>
    - `pnpm turbo run typecheck` passes (proves barrel exports resolve correctly)
    - `pnpm --filter @phoenix/ui run lint` passes
    - index.ts exports cn, Button, buttonVariants, Input, Textarea, all Select parts, Checkbox, RadioGroup, RadioGroupItem, Label, all Dialog parts
    - No "export not found" TypeScript errors
  </verify>
  <done>
    All Phase 3 components importable from @phoenix/ui via barrel export. `import { Button, Input, Select, Checkbox, RadioGroup, Dialog } from "@phoenix/ui"` works with full TypeScript autocomplete. COMP-14 satisfied.
  </done>
</task>

</tasks>

<verification>
1. `pnpm turbo run typecheck` — all packages pass type checking
2. `pnpm --filter @phoenix/ui run lint` — no lint errors
3. dialog.tsx exports all 10 Dialog parts
4. index.ts re-exports all components from all 7 component files + utils
5. No hardcoded color values in dialog.tsx
6. Dialog animations use Tailwind animate-in/animate-out classes
</verification>

<success_criteria>

- COMP-08: Dialog component built on Radix Dialog primitive with compound parts
- COMP-14: All components export from packages/ui/src/index.ts barrel file
- COMP-15: Every component uses semantic token classes only (verified across all files)
- Import pattern works: `import { Button, Dialog } from "@phoenix/ui"`
  </success_criteria>

<output>
After completion, create `.planning/phases/03-core-components/03-03-SUMMARY.md`
</output>
