---
phase: 02-token-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/tokens/package.json
  - packages/tokens/src/tokens/colors.json
  - packages/tokens/src/tokens/colors.dark.json
  - packages/tokens/src/tokens/spacing.json
  - packages/tokens/src/tokens/typography.json
  - packages/tokens/src/tokens/radii.json
  - packages/tokens/src/build.mjs
  - packages/tokens/src/index.ts
  - turbo.json
autonomous: true

must_haves:
  truths:
    - 'Running pnpm build in packages/tokens generates dist/tokens.css with CSS custom properties'
    - 'Running pnpm build in packages/tokens generates dist/tokens.dark.css with .dark scoped variables'
    - 'Color tokens use OKLCH format throughout'
    - 'All token files use DTCG format ($value, $type, $description)'
    - 'Changing a seed token value and rebuilding produces updated CSS output'
  artifacts:
    - path: 'packages/tokens/src/tokens/colors.json'
      provides: 'Color scales (neutral, primary, secondary, destructive, warning, success, info) with 11 shades each + semantic tokens'
      contains: '$value'
    - path: 'packages/tokens/src/tokens/colors.dark.json'
      provides: 'Dark mode semantic color overrides'
      contains: '$value'
    - path: 'packages/tokens/src/tokens/spacing.json'
      provides: '8px-base spacing scale'
      contains: '$value'
    - path: 'packages/tokens/src/tokens/typography.json'
      provides: 'Font sizes, line heights, font families'
      contains: '$value'
    - path: 'packages/tokens/src/tokens/radii.json'
      provides: 'Border radius scale'
      contains: '$value'
    - path: 'packages/tokens/src/build.mjs'
      provides: 'Style Dictionary build script'
      contains: 'StyleDictionary'
    - path: 'packages/tokens/dist/tokens.css'
      provides: 'CSS custom properties for light mode'
      contains: ':root'
    - path: 'packages/tokens/dist/tokens.dark.css'
      provides: 'CSS custom properties for dark mode'
      contains: '.dark'
  key_links:
    - from: 'packages/tokens/src/build.mjs'
      to: 'packages/tokens/src/tokens/*.json'
      via: 'Style Dictionary source glob'
      pattern: "src/tokens/\\*\\*/\\*.json"
    - from: 'packages/tokens/src/build.mjs'
      to: 'packages/tokens/dist/'
      via: 'Style Dictionary buildPath'
      pattern: 'dist/'
    - from: 'turbo.json'
      to: 'packages/tokens/src/tokens/**/*.json'
      via: 'build task inputs'
      pattern: "src/tokens/\\*\\*/\\*.json"
---

<objective>
Create the complete design token source files in DTCG format and the Style Dictionary build pipeline that transforms them into CSS custom properties.

Purpose: This is the foundation of the entire design system -- every component in future phases references these semantic tokens. Without working token generation, nothing downstream can use the design system's colors, spacing, or typography.

Output: 5 DTCG token source files, Style Dictionary build script, generated CSS custom properties (light + dark), updated turbo.json for cache correctness.
</objective>

<execution_context>
@/Users/chris/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-token-system/02-CONTEXT.md
@.planning/phases/02-token-system/02-RESEARCH.md
@packages/tokens/package.json
@turbo.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DTCG seed token files</name>
  <files>
    packages/tokens/src/tokens/colors.json
    packages/tokens/src/tokens/colors.dark.json
    packages/tokens/src/tokens/spacing.json
    packages/tokens/src/tokens/typography.json
    packages/tokens/src/tokens/radii.json
  </files>
  <action>
Create 5 token source files in DTCG format (using $value, $type, $description on EVERY individual token -- never on parent groups).

**colors.json:**

- 7 color scales: neutral, primary, secondary, destructive, warning, success, info
- 11 shades per scale: 50, 100, 200, 300, 400, 500, 600, 700, 800, 900, 950
- All values in OKLCH format (e.g., "oklch(0.985 0 0)")
- Default aesthetic: shadcn/ui zinc (zinc neutrals, slate-blue primary)
- Semantic tokens referencing scales via Style Dictionary aliases: background, foreground, card, card-foreground, primary, primary-foreground, secondary, secondary-foreground, muted, muted-foreground, accent, accent-foreground, destructive, destructive-foreground, border, input, ring
- Use alias syntax: "{color.neutral.50}" to reference scale values

**colors.dark.json:**

- Override ONLY semantic tokens (not full scales) with independently curated dark values
- Same semantic token names as colors.json but with dark-appropriate OKLCH values
- NOT scale inversion -- hand-picked values for each semantic token

**spacing.json:**

- 8px base unit scale: 0.5 (4px), 1 (8px), 1.5 (12px), 2 (16px), 2.5 (20px), 3 (24px), 4 (32px), 5 (40px), 6 (48px), 8 (64px), 10 (80px), 12 (96px)
- $type: "dimension" for all spacing tokens

**typography.json:**

- Fixed scale (not fluid): xs (0.75rem), sm (0.875rem), base (1rem), lg (1.125rem), xl (1.25rem), 2xl (1.5rem), 3xl (1.875rem), 4xl (2.25rem)
- Line heights for each size
- Font families: sans (system-ui stack), mono (monospace stack)
- $type: "dimension" for sizes, "fontFamily" for families

**radii.json:**

- Scale: none (0), sm (0.125rem), DEFAULT/md (0.375rem), lg (0.5rem), xl (0.75rem), 2xl (1rem), full (9999px)
- $type: "dimension" for all radius tokens

IMPORTANT: Follow DTCG spec strictly -- $type on each individual token, not on groups. Use $description on key tokens for documentation.
</action>
<verify> - All 5 JSON files exist and are valid JSON: `node -e "for (const f of ['colors','colors.dark','spacing','typography','radii']) { JSON.parse(require('fs').readFileSync('packages/tokens/src/tokens/' + f + '.json', 'utf8')); console.log(f + ': valid') }"` - Every token has $value and $type: grep for $value and $type counts should match - No $type on group nodes (only on leaf tokens with $value) - OKLCH format used in color values
</verify>
<done>
5 DTCG-compliant token source files exist with all color scales (7 x 11 shades), semantic tokens, dark mode overrides, spacing scale, typography scale, and border radii scale.
</done>
</task>

<task type="auto">
  <name>Task 2: Create Style Dictionary build pipeline and wire package</name>
  <files>
    packages/tokens/src/build.mjs
    packages/tokens/package.json
    packages/tokens/src/index.ts
    turbo.json
  </files>
  <action>
**packages/tokens/src/build.mjs:**
Create ESM build script using Style Dictionary v4 (install with `pnpm add -D style-dictionary` in packages/tokens).

Configuration:

- source: ['src/tokens/**/*.json']
- Platform "css" with transformGroup 'css':
  - File 1: dist/tokens.css -- format 'css/variables', filter OUT .dark.json tokens, outputReferences: true
  - File 2: dist/tokens.dark.css -- format 'css/variables', filter IN only .dark.json tokens, selector: '.dark', outputReferences: true
- Use `new StyleDictionary(config)` and `await sd.buildAllPlatforms()`
- Add a console.log at end confirming build success with file count

NOTE: Do NOT use sd-tailwindcss-transformer for now. The Tailwind v4 @theme approach maps CSS variables directly -- no JS preset needed. Plan 02 handles the @theme wiring.

**packages/tokens/package.json:**

- Add style-dictionary to devDependencies
- Update "build" script to: "node src/build.mjs"
- Add "exports" field mapping "./dist/tokens.css" and "./dist/tokens.dark.css" for package consumers
- Keep main/types pointing to src/index.ts for TypeScript consumers

**packages/tokens/src/index.ts:**

- Export token type definitions if useful, or keep as re-export point
- At minimum: export a comment noting CSS outputs are the primary consumable

**turbo.json:**

- Add "inputs" to the build task: ["src/**/*.ts", "src/**/*.tsx", "src/**/*.mjs", "src/tokens/**/*.json"]
- This ensures Turborepo invalidates cache when token JSON files change
- Keep existing build config (dependsOn, outputs)
  </action>
  <verify> - `cd packages/tokens && pnpm build` completes without errors - `ls packages/tokens/dist/` shows tokens.css and tokens.dark.css - `grep ':root' packages/tokens/dist/tokens.css` finds the root selector - `grep '.dark' packages/tokens/dist/tokens.dark.css` finds the dark selector - `grep 'oklch' packages/tokens/dist/tokens.css` confirms OKLCH values in output - Build completes in under 2 seconds - `pnpm turbo run build` from root succeeds - `pnpm turbo run typecheck` from root succeeds
  </verify>
  <done>
  Style Dictionary build pipeline generates tokens.css (light, :root scoped) and tokens.dark.css (.dark scoped) from DTCG source files. Turborepo correctly tracks token JSON files as build inputs. Full monorepo build and typecheck pass.
  </done>
  </task>

</tasks>

<verification>
1. `pnpm turbo run build` from repo root succeeds (all packages build)
2. `pnpm turbo run typecheck` passes across all packages
3. `packages/tokens/dist/tokens.css` contains CSS custom properties with :root selector
4. `packages/tokens/dist/tokens.dark.css` contains CSS custom properties with .dark selector
5. Token CSS uses OKLCH color format
6. Semantic tokens (--background, --foreground, --primary, etc.) present in output
7. Modifying a value in colors.json and rebuilding produces different CSS output (cache invalidation works)
</verification>

<success_criteria>

- Style Dictionary build transforms DTCG JSON tokens into CSS custom properties
- Light mode tokens scoped to :root, dark mode tokens scoped to .dark
- All 7 color scales with 11 shades each present
- All semantic tokens following shadcn/ui convention present
- Spacing, typography, and border-radius tokens present
- Build completes in under 2 seconds
- Turborepo cache invalidates on token file changes
  </success_criteria>

<output>
After completion, create `.planning/phases/02-token-system/02-01-SUMMARY.md`
</output>
